====================
Sensor configuration
====================

.. toctree::
   :hidden:

   multiply-factor
   new-yaml-structure
   standby-power

For each entity you want to create a virtual power sensor for you'll need to add an entry in `configuration.yaml` or use the GUI config flow.
Below you'll find a listing of possible configuration parameters for each sensor.
Not all configuration params listed below are available in the GUI, when you want to use the "advanced" options you need to use YAML configuration.

.. note::
    When you define an option per sensor it will override any :doc:`global-configuration` option

+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| Name                                      | Type      | Requirement  | Description                                                                                                                                                                                                                                                                                         | GUI |
+===========================================+===========+==============+=====================================================================================================================================================================================================================================================================================================+=====+
| entity_id                                 | string    | **Required** | HA entity ID. The id of the device you want your power sensor for                                                                                                                                                                                                                                   | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| unique_id                                 | string    | **Optional** | Powercalc tries to get a unique_id from the source entity by default. When the source entity does not have a unique_id you can configure one yourself. This allows you to change the name, area etc from the GUI. You can use for example https://www.uuidgenerator.net/ to generate a unique one   | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| manufacturer                              | string    | **Optional** | Manufacturer, most of the time this can be automatically discovered                                                                                                                                                                                                                                 | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| model                                     | string    | **Optional** | Model id, most of the time this can be automatically discovered                                                                                                                                                                                                                                     | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| standby_power                             | float     | **Optional** | Supply the wattage when the device is off. See :doc:`standby-power`. Can also be a template                                                                                                                                                                                                         | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| sleep_power                               | object    | **Optional** | Changes the power to some value x seconds after the device has turned off. See :doc:`standby-power`.                                                                                                                                                                                                |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| unavailable_power                         | float     | **Optional** | Supply the wattage when the device has `unavailable` state. When not specified ``standby_power`` will be used, or 0.                                                                                                                                                                                | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| disable_standby_power                     | boolean   | **Optional** | Set to ``true`` to not show any power consumption when the device is standby                                                                                                                                                                                                                        |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| name                                      | string    | **Optional** | Override the name                                                                                                                                                                                                                                                                                   | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| create_energy_sensor                      | boolean   | **Optional** | Set to disable/enable energy sensor creation. When set this will override global setting ``create_energy_sensors``                                                                                                                                                                                  | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| create_utility_meters                     | boolean   | **Optional** | Set to disable/enable utility meter creation. When set this will override global setting ``create_utility_meters``. See :doc:`/sensor-types/utility-meter`                                                                                                                                          | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| utility_meter_types                       | list      | **Optional** | Define which cycles you want to create utility meters for. See utility_cycle_. This will override global setting ``utility_meter_types``                                                                                                                                                            |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| utility_meter_offset                      | string    | **Optional** | Define the offset for utility meters. See utility_offset_.                                                                                                                                                                                                                                          |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| utility_meter_tariffs                     | list      | **Optional** | Define different tariffs. See utility_tariffs_.                                                                                                                                                                                                                                                     | x   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| custom_model_directory                    | string    | **Optional** | Directory for a custom light model. Relative from the `config` directory                                                                                                                                                                                                                            |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| power_sensor_category                     | string    | **Optional** | Category for the created power sensor. See `HA docs <https://developers.home-assistant.io/docs/core/entity/#generic-properties>`_.                                                                                                                                                                  |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| power_sensor_naming                       | string    | **Optional** | Change the name (and id) of the sensors. Use the `{}` placeholder for the entity name of your appliance. When set this will override global setting ``power_sensor_naming``. Also see :doc:`/misc/naming`.                                                                                          |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| energy_sensor_category                    | string    | **Optional** | Category for the created energy sensor. See `HA docs <https://developers.home-assistant.io/docs/core/entity/#generic-properties>`_.                                                                                                                                                                 |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| energy_sensor_naming                      | string    | **Optional** | Change the name (and id) of the sensors. Use the `{}` placeholder for the entity name of your appliance. When set this will override global setting ``energy_sensor_naming``. Also see :doc:`/misc/naming`.                                                                                         |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| energy_integration_method                 | string    | **Optional** | Integration method for the energy sensor. See `HA docs <https://www.home-assistant.io/integrations/integration/#method>`__                                                                                                                                                                          |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| energy_sensor_unit_prefix                 | string    | **Optional** | Unit prefix for the energy sensor. See `HA docs <https://www.home-assistant.io/integrations/integration/#unit_prefix>`__. Set to `none` for to create a Wh sensor                                                                                                                                   |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| mode                                      | string    | **Optional** | Calculation mode, one of ``lut``, ``linear``, ``fixed``. The default mode is ``lut``                                                                                                                                                                                                                | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| :doc:`multiply_factor <multiply-factor>`  | float     | **Optional** | Multiplies the calculated power by this number. See :doc:`multiply-factor`                                                                                                                                                                                                                          | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| multiply_factor_standby                   | boolean   | **Optional** | When set to ``true`` the ``multiply_factor`` will also be applied to the standby power                                                                                                                                                                                                              |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| fixed                                     | object    | **Optional** | :doc:`Fixed strategy options </strategies/fixed>`                                                                                                                                                                                                                                                   | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| linear                                    | object    | **Optional** | :doc:`Linear strategy options </strategies/linear>`                                                                                                                                                                                                                                                 | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| wled                                      | object    | **Optional** | :doc:`WLED strategy options </strategies/wled>`                                                                                                                                                                                                                                                     | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| entities                                  | list      | **Optional** | Makes it possible to add multiple entities at once in one powercalc entry. Also enable possibility to create group sensors automatically. See :doc:`/sensor-types/group`                                                                                                                            |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| create_group                              | string    | **Optional** | This setting is only applicable when you also use ``entities`` setting or ``include``. Define a group name here. See :doc:`/sensor-types/group`                                                                                                                                                     |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| hide_members                              | boolean   | **Optional** | Hide all group members in HA GUI, only applicable when ``create_group`` is also defined.                                                                                                                                                                                                            | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| include                                   | object    | **Optional** | Use this in combination with ``create_group`` to automatically include entities from a certain area, group or template. See :doc:`/sensor-types/group/include-entities`                                                                                                                             |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| power_sensor_id                           | string    | **Optional** | Entity id of an existing power sensor. This can be used to let powercalc create energy sensors and utility meters. This will create no virtual power sensor.                                                                                                                                        |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| force_energy_sensor_creation              | boolean   | **Optional** | Set this to ``true`` when you want a new energy sensor to be created for the power sensor with ``power_sensor_id``, even if the device already has an energy sensor entity of its own.                                                                                                              |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| force_calculate_group_energy              | boolean   | **Optional** | Set this to ``true`` when you want to create a Riemann sum sensor for powercalc group. By default the group energy sensor sums all individual energy sensors from member entities.                                                                                                                  |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| energy_sensor_id                          | string    | **Optional** | Entity id of an existing energy sensor. Mostly used in conjunction with ``power_sensor_id``.                                                                                                                                                                                                        |     |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| ignore_unavailable_state                  | boolean   | **Optional** | Set this to ``true`` when you want the power sensor to display a value (``unavailable_power``, ``standby_power`` or 0) regardless of whether the source entity is available. The can be useful for example on a TV which state can become unavailable when it is set to off.                        | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+
| calculation_enabled_condition             | template  | **Optional** | The configured power calculation strategy will only be executed when this template results in True, otherwise the power sensor will display 0                                                                                                                                                       | X   |
+-------------------------------------------+-----------+--------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----+

.. _utility_tariffs: https://www.home-assistant.io/integrations/utility_meter/#tariffs
.. _utility_cycle: https://www.home-assistant.io/integrations/utility_meter/#cycle
.. _utility_offset: https://www.home-assistant.io/integrations/utility_meter/#offset
